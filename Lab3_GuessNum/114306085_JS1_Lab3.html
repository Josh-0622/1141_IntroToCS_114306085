<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>數字猜謎遊戲</title>
</head>
<body>

    <h1>114306085_Number Guessing Game</h1>

    <div id="gameResult">
        <p>遊戲開始！試著猜出一個 1 到 100 之間的數字。</p>
    </div>

    <script>
        // 變數初始化

        // 產生一個 1 到 100 之間的隨機整數作為答案
        const ANSWER = Math.floor(Math.random() * 100) + 1;
        // 剩餘機會數
        let chances = 7;
        // 猜測範圍
        let minRange = 1;
        let maxRange = 100;
        // 遊戲是否結束
        let gameOver = false;

        const resultDiv = document.getElementById('gameResult');

        function startGame() {
            // 主要的遊戲迴圈，只要還有機會且遊戲未結束就執行
            while (chances > 0 && !gameOver) {
                // 減少機會數
                chances--;

                // 建立提示訊息
                let promptMessage = `請輸入 ${minRange} 到 ${maxRange} 之間的整數。\n你還有 ${chances + 1} 次機會。`;

                // 讓使用者輸入猜測的數字
                const input = window.prompt(promptMessage);

                // --- 輸入驗證 ---

                // 檢查是否為空值或取消
                if (input === null || input.trim() === "") {
                    // 如果使用者點擊取消或輸入空白，跳出本次迴圈繼續下次嘗試
                    chances++; // 沒猜，所以機會數加回
                    window.alert("請勿輸入空白或取消。");
                    continue;
                }

                // 將輸入轉為數字
                const guess = Number(input);

                // 檢查是否為非數字 (NaN)
                if (isNaN(guess)) {
                    chances++; // 機會數加回
                    window.alert("請輸入有效的數字。");
                    continue;
                }
                
                // 檢查是否超出有效範圍
                if (guess < minRange || guess > maxRange) {
                    chances++; // 機會數加回
                    window.alert(`請輸入有效範圍內的數字(不能超出 ${minRange} 到 ${maxRange})!`);
                    continue;
                }

                // 處理猜測結果
                if (guess === ANSWER) {
                    // 猜對了
                    window.alert(`恭喜你答對了!正確答案是${ANSWER}`);
                    resultDiv.innerHTML = '<img src="correct.JPG" alt="正確答案">';
                    gameOver = true;
                    break; // 跳出迴圈
                } else if (guess < ANSWER) {
                    // 猜太小
                    window.alert("猜太小了! 請嘗試更大的數字。");
                    // 更新最小範圍，但不能超過當前的答案
                    minRange = Math.max(minRange, guess + 1);
                } else if (guess > ANSWER) {
                    // 猜太大
                    window.alert("猜太大了! 請嘗試更小的數字。");
                    // 更新最大範圍，但不能小於當前的答案
                    maxRange = Math.min(maxRange, guess - 1);
                }

                // 如果還有機會，更新顯示提示
                if (chances > 0) {
                     window.alert(`你還有 ${chances} 次機會。新的範圍是 ${minRange} 到 ${maxRange}。`);
                }
            }

            // 遊戲結束後的處理
            if (!gameOver) {
                // 機會用盡
                window.alert(`機會用盡。正確答案是${ANSWER}`);
                resultDiv.innerHTML = '<img src="wrong.JPG" alt="猜錯了">';
            }
        }

        // 呼叫主遊戲函式
        startGame();

    </script>
</body>
</html>
